(this["webpackJsonppaportal-acs-host"]=this["webpackJsonppaportal-acs-host"]||[]).push([[0],{803:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n(71),c=n.n(a),o=n(3),s=n.n(o),i=n(298),u=n(12),d=n(248),p=n(972),l=n(973),m=n(970),b=n(971),j=n(417),h=n(975),v=n(85);var f=function(){var t=document.getElementById("acs-host"),e="true"===(null===t||void 0===t?void 0:t.getAttribute("data-use-chat")),n=(null===t||void 0===t?void 0:t.getAttribute("data-name"))+"",a=(null===t||void 0===t?void 0:t.getAttribute("data-meetinglink"))+"",c=(null===t||void 0===t?void 0:t.getAttribute("data-connectionstring"))+"",o=Object(r.useMemo)((function(){var t=a.replace("https://teams.microsoft.com/l/meetup-join/","");if(!(t=(t=t.replaceAll("%3a",":").replace("%40","@")).split(/^(.*?@thread\.v2)/gm)[1])||0===t.length)throw new Error("Could not get chat thread from teams link");return t}),[a]),f=Object(r.useMemo)((function(){var t=new RegExp("endpoint=(https://.*)(?:;|$)").exec(c);if(t&&t.length>1)return t[1];throw new Error("Could not get endpoint from connection string")}),[c]),O=Object(r.useState)(),g=Object(u.a)(O,2),k=g[0],w=g[1],x=Object(r.useState)(),I=Object(u.a)(x,2),A=I[0],U=I[1],y=Object(j.useAsyncMemo)(Object(i.a)(s.a.mark((function t(){var n,r,a,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new h.a(c),t.next=3,n.createUserAndToken(e?["voip","chat"]:["voip"]);case 3:return r=t.sent,a=r.token,o=r.user,t.abrupt("return",{token:a,userId:o.communicationUserId});case 6:case"end":return t.stop()}}),t)}))),[c]);return Object(r.useEffect)((function(){var t=function(){var t=Object(i.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e,!t.t0){t.next=7;break}return t.t1=U,t.next=5,Object(p.a)({endpointUrl:f,userId:{kind:"communicationUser",communicationUserId:y.userId},displayName:n,credential:new d.a(y.token),threadId:o});case 5:t.t2=t.sent,(0,t.t1)(t.t2);case 7:return t.t3=w,t.next=10,Object(l.a)({userId:{kind:"communicationUser",communicationUserId:y.userId},displayName:n,credential:new d.a(y.token),locator:{meetingLink:a+""}});case 10:t.t4=t.sent,(0,t.t3)(t.t4);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();y&&t()}),[e,n,f,a,o,y]),k&&A?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(m.a,{adapter:k}),Object(v.jsx)(b.a,{adapter:A})]}):k?Object(v.jsx)(m.a,{adapter:k}):Object(v.jsx)("div",{})};c.a.render(Object(v.jsx)(f,{}),document.getElementById("acs-host"))}},[[803,1,2]]]);